#Set loot tables for mob variants
#Cat
data merge entity @e[type=ocelot,tag=!head_updated,nbt={CatType:0},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/cat/ocelot",Tags:["head_updated"]}
data merge entity @e[type=ocelot,tag=!head_updated,nbt={CatType:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/cat/black_cat",Tags:["head_updated"]}
data merge entity @e[type=ocelot,tag=!head_updated,nbt={CatType:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/cat/ginger_cat",Tags:["head_updated"]}
data merge entity @e[type=ocelot,tag=!head_updated,nbt={CatType:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/cat/siamese_cat",Tags:["head_updated"]}
#Creeper
data merge entity @e[type=creeper,tag=!head_updated,nbt={powered:1b},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/creeper/charged_creeper",Tags:["head_updated"]}
#Horse
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:0},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/white_horse",Tags:["head_updated"]}
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/golden_horse",Tags:["head_updated"]}
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/chestnut_horse",Tags:["head_updated"]}
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/brown_horse",Tags:["head_updated"]}
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:4},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/black_horse",Tags:["head_updated"]}
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:5},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/gray_horse",Tags:["head_updated"]}
data merge entity @e[type=horse,tag=!head_updated,nbt={Variant:6},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/horse/dark_horse",Tags:["head_updated"]}
#Llama
data merge entity @e[type=llama,tag=!head_updated,nbt={Variant:0},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/llama/creamy_llama",Tags:["head_updated"]}
data merge entity @e[type=llama,tag=!head_updated,nbt={Variant:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/llama/white_llama",Tags:["head_updated"]}
data merge entity @e[type=llama,tag=!head_updated,nbt={Variant:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/llama/brown_llama",Tags:["head_updated"]}
data merge entity @e[type=llama,tag=!head_updated,nbt={Variant:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/llama/gray_llama",Tags:["head_updated"]}
#Parrot
data merge entity @e[type=parrot,tag=!head_updated,nbt={Variant:0},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/parrot/red_parrot",Tags:["head_updated"]}
data merge entity @e[type=parrot,tag=!head_updated,nbt={Variant:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/parrot/blue_parrot",Tags:["head_updated"]}
data merge entity @e[type=parrot,tag=!head_updated,nbt={Variant:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/parrot/green_parrot",Tags:["head_updated"]}
data merge entity @e[type=parrot,tag=!head_updated,nbt={Variant:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/parrot/cyan_parrot",Tags:["head_updated"]}
data merge entity @e[type=parrot,tag=!head_updated,nbt={Variant:4},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/parrot/gray_parrot",Tags:["head_updated"]}
#Rabbit
data merge entity @e[type=rabbit,tag=!head_updated,nbt={CustomName:"{\"text\":\"Toast\"}"},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/toast_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:0},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/brown_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/white_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/black_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/splotched_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:4},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/gold_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:5},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/pepper_rabbit",Tags:["head_updated"]}
data merge entity @e[type=rabbit,tag=!head_updated,nbt={RabbitType:99},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/rabbit/killer_bunny",Tags:["head_updated"]}
#Sheep
data merge entity @e[type=sheep,tag=!head_updated,nbt={CustomName:"{\"text\":\"jeb_\"}"},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/sheep/jeb_sheep",Tags:["head_updated"]}
#Villager
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:0,Career:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/farmer/farmer",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:0,Career:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/farmer/fisherman",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:0,Career:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/farmer/shepherd",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:0,Career:4},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/farmer/fletcher",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:1,Career:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/librarian/librarian",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:1,Career:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/librarian/cartographer",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/cleric",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:3,Career:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/blacksmith/armourer",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:3,Career:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/blacksmith/weaponsmith",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:3,Career:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/blacksmith/toolsmith",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:4,Career:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/butcher/butcher",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:4,Career:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/butcher/leatherworker",Tags:["head_updated"]}
data merge entity @e[type=villager,tag=!head_updated,nbt={Profession:5},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/villager/nitwit",Tags:["head_updated"]}
#Wither
data merge entity @e[type=wither,tag=!head_updated,sort=nearest,limit=1] {DeathLootTable:"koyc:entities/wither/wither",Tags:["head_updated"]}
#Zombie Villager
data merge entity @e[type=zombie_villager,tag=!head_updated,nbt={Profession:0},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/zombie_villager/zombie_farmer",Tags:["head_updated"]}
data merge entity @e[type=zombie_villager,tag=!head_updated,nbt={Profession:1},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/zombie_villager/zombie_librarian",Tags:["head_updated"]}
data merge entity @e[type=zombie_villager,tag=!head_updated,nbt={Profession:2},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/zombie_villager/zombie_cleric",Tags:["head_updated"]}
data merge entity @e[type=zombie_villager,tag=!head_updated,nbt={Profession:3},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/zombie_villager/zombie_smith",Tags:["head_updated"]}
data merge entity @e[type=zombie_villager,tag=!head_updated,nbt={Profession:4},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/zombie_villager/zombie_butcher",Tags:["head_updated"]}
data merge entity @e[type=zombie_villager,tag=!head_updated,nbt={Profession:5},sort=nearest,limit=1] {DeathLootTable:"koyc:entities/zombie_villager/zombie_nitwit",Tags:["head_updated"]}

#Give mined custom heads back their title
# * The following commands cause the most strain on the server, so optimise them!
# 1. data merge entity @e[sort=nearest,limit=1] > execute as @e[] run data merge entity @s
# * Since we only expext one item to be found occasionally we can assume that the @e[limit=1] selector does not slow down execution
# 2. Split into 40ths so each command runs once every 40 ticks and load is distributed across the server (Item PickupDelay is 40 ticks so no chance of item data not updating in time)

data merge entity @e[type=item,tag=!head_updated,nbt={Item:{id:"minecraft:player_head"}},sort=nearest,limit=1] {PickupDelay: 40s, Tags:[head_updated]}

execute as @r if score ticks_fourtieths ticks_fourtieths matches 0 run function koyc:custom_heads/ticked/ticked0
execute as @r if score ticks_fourtieths ticks_fourtieths matches 1 run function koyc:custom_heads/ticked/ticked1
execute as @r if score ticks_fourtieths ticks_fourtieths matches 2 run function koyc:custom_heads/ticked/ticked2
execute as @r if score ticks_fourtieths ticks_fourtieths matches 3 run function koyc:custom_heads/ticked/ticked3
execute as @r if score ticks_fourtieths ticks_fourtieths matches 4 run function koyc:custom_heads/ticked/ticked4
execute as @r if score ticks_fourtieths ticks_fourtieths matches 5 run function koyc:custom_heads/ticked/ticked5
execute as @r if score ticks_fourtieths ticks_fourtieths matches 6 run function koyc:custom_heads/ticked/ticked6
execute as @r if score ticks_fourtieths ticks_fourtieths matches 7 run function koyc:custom_heads/ticked/ticked7
execute as @r if score ticks_fourtieths ticks_fourtieths matches 8 run function koyc:custom_heads/ticked/ticked8
execute as @r if score ticks_fourtieths ticks_fourtieths matches 9 run function koyc:custom_heads/ticked/ticked9
execute as @r if score ticks_fourtieths ticks_fourtieths matches 10 run function koyc:custom_heads/ticked/ticked10
execute as @r if score ticks_fourtieths ticks_fourtieths matches 11 run function koyc:custom_heads/ticked/ticked11
execute as @r if score ticks_fourtieths ticks_fourtieths matches 12 run function koyc:custom_heads/ticked/ticked12
execute as @r if score ticks_fourtieths ticks_fourtieths matches 13 run function koyc:custom_heads/ticked/ticked13
execute as @r if score ticks_fourtieths ticks_fourtieths matches 14 run function koyc:custom_heads/ticked/ticked14
execute as @r if score ticks_fourtieths ticks_fourtieths matches 15 run function koyc:custom_heads/ticked/ticked15
execute as @r if score ticks_fourtieths ticks_fourtieths matches 16 run function koyc:custom_heads/ticked/ticked16
execute as @r if score ticks_fourtieths ticks_fourtieths matches 17 run function koyc:custom_heads/ticked/ticked17
execute as @r if score ticks_fourtieths ticks_fourtieths matches 18 run function koyc:custom_heads/ticked/ticked18
execute as @r if score ticks_fourtieths ticks_fourtieths matches 19 run function koyc:custom_heads/ticked/ticked19
execute as @r if score ticks_fourtieths ticks_fourtieths matches 20 run function koyc:custom_heads/ticked/ticked20
execute as @r if score ticks_fourtieths ticks_fourtieths matches 21 run function koyc:custom_heads/ticked/ticked21
execute as @r if score ticks_fourtieths ticks_fourtieths matches 22 run function koyc:custom_heads/ticked/ticked22
execute as @r if score ticks_fourtieths ticks_fourtieths matches 23 run function koyc:custom_heads/ticked/ticked23
execute as @r if score ticks_fourtieths ticks_fourtieths matches 24 run function koyc:custom_heads/ticked/ticked24
execute as @r if score ticks_fourtieths ticks_fourtieths matches 25 run function koyc:custom_heads/ticked/ticked25
execute as @r if score ticks_fourtieths ticks_fourtieths matches 26 run function koyc:custom_heads/ticked/ticked26
execute as @r if score ticks_fourtieths ticks_fourtieths matches 27 run function koyc:custom_heads/ticked/ticked27
execute as @r if score ticks_fourtieths ticks_fourtieths matches 28 run function koyc:custom_heads/ticked/ticked28
execute as @r if score ticks_fourtieths ticks_fourtieths matches 29 run function koyc:custom_heads/ticked/ticked29
execute as @r if score ticks_fourtieths ticks_fourtieths matches 30 run function koyc:custom_heads/ticked/ticked30
execute as @r if score ticks_fourtieths ticks_fourtieths matches 31 run function koyc:custom_heads/ticked/ticked31
execute as @r if score ticks_fourtieths ticks_fourtieths matches 32 run function koyc:custom_heads/ticked/ticked32
execute as @r if score ticks_fourtieths ticks_fourtieths matches 33 run function koyc:custom_heads/ticked/ticked33
execute as @r if score ticks_fourtieths ticks_fourtieths matches 34 run function koyc:custom_heads/ticked/ticked34
execute as @r if score ticks_fourtieths ticks_fourtieths matches 35 run function koyc:custom_heads/ticked/ticked35
execute as @r if score ticks_fourtieths ticks_fourtieths matches 36 run function koyc:custom_heads/ticked/ticked36
execute as @r if score ticks_fourtieths ticks_fourtieths matches 37 run function koyc:custom_heads/ticked/ticked37
execute as @r if score ticks_fourtieths ticks_fourtieths matches 38 run function koyc:custom_heads/ticked/ticked38
execute as @r if score ticks_fourtieths ticks_fourtieths matches 39 run function koyc:custom_heads/ticked/ticked39